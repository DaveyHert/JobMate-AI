new class{constructor(){this.init()}init(){chrome.runtime.onInstalled.addListener((()=>{this.initializeDefaultData()})),chrome.runtime.onMessage.addListener(((e,a,t)=>(this.handleMessage(e,a,t),!0))),this.setupContextMenus()}async initializeDefaultData(){try{if(!(await chrome.storage.local.get(["jobMateData"])).jobMateData){const e={currentProfile:"product-manager",applications:[],weeklyGoal:{current:0,target:10},profiles:{"product-manager":{name:"Product Manager",personalInfo:{firstName:"John",lastName:"Doe",fullName:"John Doe",email:"john.doe@email.com",phone:"(555) 123-4567",address:"123 Main Street",city:"San Francisco",state:"CA",zipCode:"94102",country:"United States",linkedIn:"https://linkedin.com/in/johndoe",website:"https://johndoe.dev",github:"https://github.com/johndoe"},professional:{currentTitle:"Senior Product Manager",company:"Tech Corp",experience:"5+ years",salary:"$140,000",salaryMin:"$130,000",salaryMax:"$150,000",availability:"Immediately",workAuthorization:"US Citizen",preferredLocation:"San Francisco, CA"},documents:{resumeUrl:"/resume-pm.pdf",coverLetterUrl:"/cover-letter-pm.pdf"}},"software-engineer":{name:"Software Engineer",personalInfo:{firstName:"John",lastName:"Doe",fullName:"John Doe",email:"john.doe@email.com",phone:"(555) 123-4567",address:"123 Main Street",city:"San Francisco",state:"CA",zipCode:"94102",country:"United States",linkedIn:"https://linkedin.com/in/johndoe",website:"https://johndoe.dev",github:"https://github.com/johndoe"},professional:{currentTitle:"Senior Software Engineer",company:"Tech Corp",experience:"5+ years",salary:"$120,000",salaryMin:"$110,000",salaryMax:"$130,000",availability:"Immediately",workAuthorization:"US Citizen",preferredLocation:"San Francisco, CA"},documents:{resumeUrl:"/resume-swe.pdf",coverLetterUrl:"/cover-letter-swe.pdf"}}},settings:{darkMode:!1,autoFillEnabled:!0,notifications:!0,weeklyGoalReminders:!0}};await chrome.storage.local.set({jobMateData:e})}}catch(e){}}async handleMessage(e,a,t){try{switch(e.action){case"trackApplication":await this.handleTrackApplication(e.data,t);break;case"getApplications":await this.getApplications(t);break;case"updateApplicationStatus":await this.updateApplicationStatus(e.applicationId,e.status,t);break;case"generateCoverLetter":await this.generateCoverLetter(e.jobDescription,e.profile,t);break;case"analyzeJobFit":await this.analyzeJobFit(e.jobDescription,e.profile,t);break;default:t({error:"Unknown action"})}}catch(o){t({error:o instanceof Error?o.message:"Unknown error"})}}async handleTrackApplication(e,a){try{const t=(await chrome.storage.local.get(["jobMateData"])).jobMateData||{};t.applications||(t.applications=[]);const o={id:Date.now(),...e,status:"applied",dateApplied:(new Date).toISOString(),notes:""};t.applications.unshift(o),t.weeklyGoal||(t.weeklyGoal={current:0,target:10}),t.weeklyGoal.current++,await chrome.storage.local.set({jobMateData:t}),a({success:!0,application:o})}catch(t){a({error:t instanceof Error?t.message:"Failed to track application"})}}async getApplications(e){try{const a=await chrome.storage.local.get(["jobMateData"]);e({applications:(a.jobMateData||{}).applications||[]})}catch(a){e({error:a instanceof Error?a.message:"Failed to get applications"})}}async updateApplicationStatus(e,a,t){try{const o=(await chrome.storage.local.get(["jobMateData"])).jobMateData||{};if(o.applications){const i=o.applications.find((a=>a.id===e));i?(i.status=a,await chrome.storage.local.set({jobMateData:o}),t({success:!0})):t({error:"Application not found"})}else t({error:"No applications found"})}catch(o){t({error:o instanceof Error?o.message:"Failed to update application"})}}async generateCoverLetter(e,a,t){try{t({success:!0,coverLetter:`Dear Hiring Manager,\n\nI am writing to express my strong interest in the ${a.professional.currentTitle} position. With ${a.professional.experience} of experience in the field, I am confident that my skills and background make me an ideal candidate for this role.\n\nIn my current position at ${a.professional.company}, I have successfully [specific achievements related to the job description]. My expertise in [relevant skills] aligns perfectly with your requirements.\n\nI am particularly excited about this opportunity because [reason specific to the company/role]. I believe my experience in [relevant area] would allow me to make an immediate impact on your team.\n\nThank you for considering my application. I look forward to discussing how my background and enthusiasm can contribute to your organization's success.\n\nBest regards,\n${a.personalInfo.fullName}`,metadata:{generatedAt:(new Date).toISOString(),jobDescriptionLength:e.length,profile:a.professional.currentTitle}})}catch(o){t({error:o instanceof Error?o.message:"Failed to generate cover letter"})}}async analyzeJobFit(e,a,t){try{t({success:!0,analysis:{score:Math.floor(30*Math.random())+70,matches:["JavaScript","React","Node.js","Product Management","Agile"],missing:["Python","AWS","Machine Learning"],recommendations:["Highlight your React experience in your resume","Mention any cloud computing experience you have","Emphasize your leadership and team collaboration skills","Include specific metrics from your previous roles"],keyRequirements:[{requirement:"Bachelor's degree",match:!0},{requirement:"5+ years experience",match:!0},{requirement:"JavaScript proficiency",match:!0},{requirement:"Python experience",match:!1},{requirement:"Cloud platforms",match:!1}]},metadata:{analyzedAt:(new Date).toISOString(),jobDescriptionLength:e.length,profile:a.professional.currentTitle}})}catch(o){t({error:o instanceof Error?o.message:"Failed to analyze job fit"})}}setupContextMenus(){chrome.runtime.onInstalled.addListener((()=>{chrome.contextMenus.create({id:"autoFill",title:"Auto-fill form with JobMate AI+",contexts:["page"]}),chrome.contextMenus.create({id:"trackApplication",title:"Track this job application",contexts:["page"]})})),chrome.contextMenus.onClicked.addListener(((e,a)=>{if(a?.id)switch(e.menuItemId){case"autoFill":chrome.tabs.sendMessage(a.id,{action:"autoFill"});break;case"trackApplication":chrome.tabs.sendMessage(a.id,{action:"trackApplication"})}}))}};
